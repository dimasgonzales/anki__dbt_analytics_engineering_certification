---
tags:
- card_type/scenario
- materializations
- state-concepts
- versioning
citations:
- cleaned_docs/snapshots/rank_5.md
guid: 78dd1407d8
source: llm
uuid: b3c2582a-bc63-5e74-9d5f-49395007fa1e
---

<front>

You are building an incremental model on a database that does not support the `merge` command (e.g., older versions of Postgres or Redshift), but you must prevent duplicates based on an `order_id`. Which strategy should you use?

</front>

---

<back>

Use `delete+insert`.
This strategy deletes rows in the destination table that match the `unique_key` of the new batch before inserting the new rows. It mimics upsert behavior without needing a native SQL `MERGE` statement.
```yaml
{{ config(
  materialized='incremental',
  unique_key='order_id',
  incremental_strategy='delete+insert'
) }}
```

</back>
