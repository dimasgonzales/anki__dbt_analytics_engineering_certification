---
tags:
- card_type/scenario
- lineage
- packages
citations:
- cleaned_docs/modularity/rank_10.md
guid: 3e86b5f988
source: llm
uuid: 2a048dd2-d051-5027-b26d-579e9e280595
---

<front>

You need to join `fact_revenue` and `dim_budget` on three columns: `region`, `department`, and `fiscal_year`. How would you simplify this join logic in dbt?

</front>

---

<back>

Generate a surrogate key in both upstream models using `dbt_utils.generate_surrogate_key` and join on that single column.
```sql
-- In upstream models
{{ dbt_utils.generate_surrogate_key(['region', 'department', 'fiscal_year']) }} as budget_key

-- In downstream join
ON revenue.budget_key = budget.budget_key
```

</back>
