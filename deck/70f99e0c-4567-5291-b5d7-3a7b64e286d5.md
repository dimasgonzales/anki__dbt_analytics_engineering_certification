---
tags:
  - materializations
  - compiled-code
  - snapshots
citations:
- cleaned_docs/sql-performance/rank_10.md
guid: 643580ced1
source: llm
uuid: 70f99e0c-4567-5291-b5d7-3a7b64e286d5
---

<front>

You have an incremental model for `orders`. How would you write the SQL logic to ensure only new orders (based on `order_date`) are processed during incremental runs?

</front>

---

<back>

Add a `WHERE` clause that filters for dates greater than the max date currently in the table, wrapped in the incremental macro check.

```sql
SELECT * FROM {{ source('raw', 'orders') }}
{% if is_incremental() %}
  WHERE order_date > (SELECT MAX(order_date) FROM {{ this }})
{% endif %}
```

</back>
