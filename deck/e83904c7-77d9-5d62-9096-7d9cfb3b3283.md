---
tags:
- card_type/scenario
- debugging/compiled-code
- development/cli-commands
- testing/test-types
citations:
- cleaned_docs/contracts/rank_6.md
guid: b0a99b595a
source: llm
uuid: e83904c7-77d9-5d62-9096-7d9cfb3b3283
---

<front>

A developer defines a `primary_key` constraint on a Snowflake model but notices duplicate keys exist after a successful `dbt run`. How should they modify the project to ensure the pipeline catches these duplicates?

</front>

---

<back>

They must add a standard `unique` data test to the column in addition to the constraint.
```yaml
columns:
  - name: id
    data_tests:
      - unique
```
Since Snowflake does not enforce the PK constraint, the test is necessary to fail the pipeline on duplicates.

</back>
