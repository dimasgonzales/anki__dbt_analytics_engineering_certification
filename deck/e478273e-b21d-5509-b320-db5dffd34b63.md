---
tags:
  - test-types
  - contracts
  - modularity
citations:
- cleaned_docs/docs-generation/rank_5.md
guid: aca1171c84
source: llm
uuid: e478273e-b21d-5509-b320-db5dffd34b63
---

<front>

You have a model `fct_customer_orders` derived from a join where one customer can have multiple orders. You attempt to use `customer_id` as the primary key, but the `unique` test fails. What is the issue and how should you resolve it?

</front>

---

<back>

The issue is that `customer_id` does not represent the unique grain of the table (individual orders). To resolve this, you must either use the natural key of the order (`order_id`) or create a surrogate key if the unique grain is a combination of columns (e.g., `customer_id` and `transaction_date`).

</back>
