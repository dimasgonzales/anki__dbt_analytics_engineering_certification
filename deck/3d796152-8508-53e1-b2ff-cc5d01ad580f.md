---
tags:
- dbt-clone
- packages
- selectors
citations:
- cleaned_docs/seeds/rank_8.md
guid: 28b05f0961
source: llm
uuid: 3d796152-8508-53e1-b2ff-cc5d01ad580f
---

<front>

Your raw data schema contains 12 monthly tables named `orders_2023_01`, `orders_2023_02`, etc. How would you create a single staging model for these without writing manual SQL for each table?

</front>

---

<back>

Use `dbt_utils` to dynamically union them based on the table pattern.

```sql
{{ dbt_utils.union_relations(
    relations=dbt_utils.get_relations_by_pattern(
        schema='raw_commerce',
        table_pattern='orders_%'
    )
) }}
```

</back>
