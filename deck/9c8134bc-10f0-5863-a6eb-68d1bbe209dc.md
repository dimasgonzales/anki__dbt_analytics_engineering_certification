---
tags:
- card_type/scenario
- debugging/compiled-code
- debugging/yaml-compilation
- pipelines/dbt-clone
citations:
- cleaned_docs/jinja-macros/rank_6.md
guid: ca68a7ff45
source: llm
uuid: 9c8134bc-10f0-5863-a6eb-68d1bbe209dc
---

<front>

You have a macro that queries a staging table to get a list of column names. When running `dbt compile`, it fails with a "relation does not exist" error, even though the table exists in the database. What is the likely cause?

</front>

---

<back>

The `run_query` function is executing during the **parsing phase** before the model definitions are fully resolved. 

To fix this, wrap the query execution logic in an `{% if execute %}` block so it only runs during the active execution phase.

</back>
