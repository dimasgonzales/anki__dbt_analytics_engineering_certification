---
tags:
- modularity
- packages
- seeds
citations:
- cleaned_docs/docs-generation/rank_5.md
guid: be237d2b53
source: llm
uuid: 001df864-548b-5dc7-90bc-846759332d75
---

<front>

You are migrating a dbt project from Postgres to Snowflake. You notice the manual surrogate key logic `md5(id || '-' || type)` is behaving differently because Snowflake handles concatenation with NULLs differently than Postgres. How should you refactor this code?

</front>

---

<back>

Replace the manual concatenation with the `dbt_utils` macro. This macro standardizes behavior across warehouses.

Refactored Code:
```sql
{{ dbt_utils.generate_surrogate_key(['id', 'type']) }}
```

</back>
