---
tags:
- model-access
- seeds
- state-concepts
citations:
- cleaned_docs/jinja-macros/rank_8.md
guid: 6d2468fa28
source: llm
uuid: 64520c97-b3a0-5056-b34d-2ddb42089956
---

<front>

You are writing a custom `ref` macro to add logging, but dbt throws a `RecursionError`. Given the code below, how do you fix it?

```sql
{% macro ref(model_name) %}
  {{ log("Ref called", info=True) }}
  {{ return(ref(model_name)) }}
{% endmacro %}
```

</front>

---

<back>

You must replace `ref(model_name)` with `builtins.ref(model_name)` inside the return statement.

Calling `ref()` inside a macro named `ref` calls the custom macro itself recursively. Using `builtins` allows you to access the underlying dbt compilation method.

</back>
