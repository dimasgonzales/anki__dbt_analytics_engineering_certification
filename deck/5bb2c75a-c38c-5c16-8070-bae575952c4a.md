---
tags:
- card_type/scenario
- modularity
- seeds
- state-concepts
citations:
- cleaned_docs/snapshots/rank_8.md
guid: 186f158a10
source: llm
uuid: 5bb2c75a-c38c-5c16-8070-bae575952c4a
---

<front>

You need to validate a business rule where `shipping_date` must not be earlier than `order_date`. This logic does not fit standard generic tests. How do you implement this in dbt?

</front>

---

<back>

Create a **singular test** by adding a `.sql` file in the `tests` directory. Write a SELECT statement that returns the **failing records** (rows where shipping date < order date).

```sql
-- tests/assert_dates_logical.sql
select * from {{ ref('orders') }}
where shipping_date < order_date
```

</back>
