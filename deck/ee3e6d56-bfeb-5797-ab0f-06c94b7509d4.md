---
tags:
- jinja-macros
- selectors
- state-concepts
citations:
- cleaned_docs/jinja-macros/rank_9.md
guid: 378918375d
source: llm
uuid: ee3e6d56-bfeb-5797-ab0f-06c94b7509d4
---

<front>

You have a macro `get_years()` that returns the list `[2020, 2021]`. 

How would you write a Jinja loop in a model to generate a generic sum statement for each year?

</front>

---

<back>

You can iterate directly over the macro call:

```sql
select
  {% for year in get_years() %}
    sum(case when year = {{ year }} then amount end) as amount_{{ year }},
  {% endfor %}
  ...
```

</back>
