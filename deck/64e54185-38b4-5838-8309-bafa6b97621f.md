---
tags:
- card_type/scenario
- development/seeds
- pipelines/dbt-clone
- state/selectors
citations:
- cleaned_docs/modularity/index.md
guid: 027ae70738
source: llm
uuid: 64e54185-38b4-5838-8309-bafa6b97621f
---

<front>

You inherit a project with a single 500-line SQL file that cleans raw data, joins three tables, and calculates metrics. How would you refactor this into a modular architecture?

</front>

---

<back>

Split the file into three layers:
1. Create **Staging models** to clean the raw sources.
2. Create **Intermediate models** to handle the joins and logic.
3. Keep the **Final model** simple, selecting from the intermediate layer for the final metrics.

</back>
