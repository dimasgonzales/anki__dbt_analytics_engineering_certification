---
tags:
- card_type/scenario
- cli-commands
- compiled-code
- state-concepts
citations:
- cleaned_docs/snapshots/rank_10.md
guid: 99be4e3450
source: llm
uuid: 04c82247-4d2e-517c-b646-a6ff4b6397a4
---

<front>

You are migrating a legacy warehouse to dbt and need to ensure your transformations are idempotent and support parallel execution. Should you use database sequences or hashed surrogate keys, and why?

</front>

---

<back>

You should use **hashed surrogate keys**. 

Database sequences are stateful (depend on run order) and can cause gaps or locking issues during parallel runs. Hashed keys are stateless and deterministic, meaning `Row A` always gets `Key A` regardless of when or how many times the model runs.

</back>
