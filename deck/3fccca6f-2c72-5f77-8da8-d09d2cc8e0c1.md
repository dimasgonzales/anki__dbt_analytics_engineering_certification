---
tags:
  - test-types
  - jinja-macros
  - test-config
citations:
- cleaned_docs/test-config/rank_6.md
guid: 38cffc7bfd
source: llm
uuid: 3fccca6f-2c72-5f77-8da8-d09d2cc8e0c1
---

<front>

You need to apply a test that fails if the distinct count of a column is less than a specific integer passed as an argument (e.g., `min_distinct_count`). Standard tests don't support this logic. How would you implement this?

</front>

---

<back>

Define a custom generic test that accepts `min_distinct_count` as an argument and uses the `having` clause to check the threshold.

```sql
{% test distinct_threshold(model, column_name, min_distinct_count) %}
  select 1
  from {{ model }}
  having count(distinct {{ column_name }}) < {{ min_distinct_count }}
{% endtest %}
```

</back>
