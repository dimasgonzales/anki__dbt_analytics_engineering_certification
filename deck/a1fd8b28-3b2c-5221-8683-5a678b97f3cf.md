---
tags:
- card_type/factual
- debugging/compiled-code
- pipelines/deployment-jobs
- state/state-concepts
citations:
- cleaned_docs/dbt-clone/rank_9.md
guid: bd281f874c
source: llm
uuid: a1fd8b28-3b2c-5221-8683-5a678b97f3cf
claim_meta:
  verdict: SUPPORTED
  explanation: "The reference text explicitly lists the two conditions for dbt to resolve a `ref()` to the state manifest when `--defer` is enabled, which match the answer exactly in meaning and order."
  citation:
    quote: "When `--defer` is enabled, dbt resolves ref calls using the state manifest instead, but only if: 1. The node isn’t among the selected nodes, *and* 2. It doesn’t exist in the database (or `--favor-state` is used)."
    is_quote_valid: true
---

<front>

What two conditions must be met for dbt to resolve a `ref()` to the state manifest namespace when running with the `--defer` flag?

</front>

---

<back>

For dbt to defer a reference to the state (usually production), two conditions must be met:
1. The referenced node is **not included** in the current run selection.
2. The referenced node **does not exist** in the current target database (unless overridden by `--favor-state`).

</back>
