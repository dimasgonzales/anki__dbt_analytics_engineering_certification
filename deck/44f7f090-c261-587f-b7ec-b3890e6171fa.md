---
tags:
- card_type/scenario
- debugging/compiled-code
- state/selectors
- state/state-concepts
citations:
- cleaned_docs/jinja-macros/rank_6.md
guid: 27e46ef830
source: llm
uuid: 44f7f090-c261-587f-b7ec-b3890e6171fa
---

<front>

You need to create a model that pivots payment methods into columns dynamically, ensuring new payment methods in the database are automatically added as columns without manual code changes. How would you accomplish this in dbt?

</front>

---

<back>

1. Use `run_query` inside `{% if execute %}` to select distinct payment methods.
2. Extract the values into a list using `.columns[0].values()`.
3. Use a Jinja `{% for %}` loop to iterate over that list and generate the `CASE WHEN` statements in your `SELECT` clause.

</back>
