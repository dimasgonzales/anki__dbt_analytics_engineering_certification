---
tags:
- card_type/scenario
- jinja-macros
- packages
- seeds
citations:
- cleaned_docs/jinja-macros/rank_2.md
guid: 7a919cfc90
source: llm
uuid: 56817085-1f0e-598b-b2f3-df705b80f5dc
---

<front>

You need to pivot the `status` column of the `orders` table into columns (e.g., `status_placed`, `status_shipped`), but the specific statuses may change over time. How should you efficiently generate the list of statuses?

</front>

---

<back>

Use `dbt_utils.get_column_values` to dynamically fetch the list of statuses from the database.

Example:
```sql
{% set statuses = dbt_utils.get_column_values(table=ref('orders'), column='status') %}
{% for status in statuses %} ... {% endfor %}
```
This avoids hardcoding values or writing complex custom introspection macros.

</back>
