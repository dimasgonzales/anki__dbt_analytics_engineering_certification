---
tags:
- contracts
- jinja-macros
- yaml-compilation
citations:
- cleaned_docs/jinja-macros/rank_3.md
guid: 8807b48db1
source: llm
uuid: 33cd6cff-3bca-5079-9255-377d1df0cbed
---

<front>

You have a macro that runs a query to inspect table schema, but `dbt compile` fails because the table does not exist yet. How do you fix this error?

</front>

---

<back>

You should wrap the query logic in an `if execute` block. 

Because dbt compiles code before running it, the query attempts to run during parsing when the table hasn't been created. Using `if execute` ensures the query only runs during the actual execution phase.

Example:
```sql
{% set results = run_query(...) if execute else [] %}
```

</back>
