---
tags:
- card_type/scenario
- jinja-macros
- modularity
- seeds
citations:
- cleaned_docs/jinja-macros/rank_4.md
guid: f54828c383
source: llm
uuid: f2a14d67-48aa-5ef0-846a-6377687d2fac
---

<front>

You have refactored a complex SQL model and want to verify that the new dbt model produces the exact same rows as the legacy table. How can you efficiently identify discrepancies?

</front>

---

<back>

Use the `dbt.except` macro to select rows present in one table but not the other. If the result set is empty, the data is identical.

```sql
-- distinct rows in new_model not in legacy_table
{{ dbt.except(ref('new_model'), source('legacy', 'table')) }}
```

</back>
