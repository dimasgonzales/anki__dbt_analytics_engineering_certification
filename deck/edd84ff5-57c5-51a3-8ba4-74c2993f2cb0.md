---
tags:
- card_type/scenario
- debugging/compiled-code
- debugging/yaml-compilation
- governance/model-access
citations:
- cleaned_docs/jinja-macros/rank_2.md
guid: 814d85538e
source: llm
uuid: edd84ff5-57c5-51a3-8ba4-74c2993f2cb0
---

<front>

A model using `run_query` fails during compilation with the error: `'NoneType' object has no attribute 'columns'`. What is the likely cause and how do you fix it?

</front>

---

<back>

The code attempts to access query results during the parsing phase when they don't exist yet.

To fix this, wrap the result processing logic in an `if execute` block and provide a default empty list for the `else` case:
```sql
{% if execute %}
  {% set results = run_query(...).columns[0].values() %}
{% else %}
  {% set results = [] %}
{% endif %}
```

</back>
