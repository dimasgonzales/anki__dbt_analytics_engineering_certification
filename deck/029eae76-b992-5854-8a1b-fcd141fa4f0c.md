---
tags:
- card_type/scenario
- seeds
- snapshots
- test-types
citations:
- cleaned_docs/packages/rank_10.md
guid: 3e220204ef
source: llm
uuid: 029eae76-b992-5854-8a1b-fcd141fa4f0c
---

<front>

You need to validate that the total revenue in a `finance_report` model matches the sum of raw transactions in `stg_payments`. A standard `unique` or `not_null` test cannot check this. What should you use?

</front>

---

<back>

Use a **singular test**. Write a `.sql` file in the `tests/` directory that joins both models and selects rows where the totals do not match.

Example:
```sql
select * from {{ ref('finance_report') }} ...
```

</back>
