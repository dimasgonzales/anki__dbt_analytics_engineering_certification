---
tags:
- jinja-macros
- packages
- selectors
citations:
- cleaned_docs/snapshots/rank_10.md
guid: 9e3e65e5a3
source: llm
uuid: 895ea95b-528d-54bf-a214-f4d5b59ce141
---

<front>

You need to create a composite primary key for a model based on `customer_id` and `order_date`, ensuring nulls are handled safely. How do you write this in your model SQL?

</front>

---

<back>

Use the `dbt_utils.generate_surrogate_key` macro with the column names provided in a list. This macro automatically handles null values to ensure consistency.

```sql
select
  {{ dbt_utils.generate_surrogate_key(['customer_id', 'order_date']) }} as id,
  ...
from ...
```

</back>
