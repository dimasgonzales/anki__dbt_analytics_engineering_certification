---
tags:
  - python-models
  - snapshots
  - materializations
citations:
- cleaned_docs/python-models/rank_1.md
guid: 216739f0f3
source: llm
uuid: a83ea617-8857-55da-b520-0b3662211ba1
---

<front>

You are writing an incremental Python model. How do you apply the logic to filter for only new rows based on a timestamp?

</front>

---

<back>

Inside the `if dbt.is_incremental:` block, you must use DataFrame filtering operations rather than SQL syntax.

```python
if dbt.is_incremental:
    # Use DataFrame API, not SQL string
    df = df.filter(df.updated_at >= max_timestamp)
```

</back>
