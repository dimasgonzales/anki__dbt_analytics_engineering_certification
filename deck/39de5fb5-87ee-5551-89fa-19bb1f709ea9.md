---
tags:
- card_type/scenario
- debugging/compiled-code
- development/materializations
- governance/versioning
citations:
- cleaned_docs/state-concepts/rank_4.md
guid: d2ce51cc7d
source: llm
uuid: 39de5fb5-87ee-5551-89fa-19bb1f709ea9
---

<front>

You are inspecting the logs of an incremental model run on a warehouse that does not support `MERGE` (like Postgres). You see a `DELETE` statement followed by an `INSERT`. Is this expected behavior?

</front>

---

<back>

Yes. On warehouses without native `MERGE` support, dbt simulates the upsert process by:
1. Identifying existing records that match the `unique_key`.
2. `DELETE`ing those records from the destination table.
3. `INSERT`ing the new versions of those records along with any completely new rows.

</back>
